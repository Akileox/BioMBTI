# 카카오톡 공유 기능 설정 가이드

## 📋 필수 작업 (사용자가 직접 해야 할 부분)

### 1. 카카오톡 개발자 등록

1. [카카오톡 개발자 콘솔](https://developers.kakao.com/) 접속
2. 카카오 계정으로 로그인
3. "내 애플리케이션" → "애플리케이션 추가하기" 클릭
4. 앱 이름 입력 (예: `Bio-MBTI`)
5. 사업자명 입력 (개인 개발자는 본인 이름 입력 가능)

### 2. 플랫폼 설정

1. 생성한 애플리케이션 선택
2. 왼쪽 메뉴에서 "앱 설정" → "플랫폼" 클릭
3. "Web 플랫폼 등록" 클릭
4. 사이트 도메인 입력:
   - 로컬 개발: `http://localhost:3000`
   - 프로덕션: `https://bio-mbti.vercel.app` (실제 배포 도메인)
5. "저장" 클릭

### 3. JavaScript 키 발급

1. 왼쪽 메뉴에서 "앱 설정" → "앱 키" 클릭
2. **JavaScript 키** 복사 (예: `abc123def456...`)

### 4. 카카오톡 메시지 템플릿 설정

1. 왼쪽 메뉴에서 "제품 설정" → "카카오톡 메시지" 클릭
2. "메시지 템플릿" 탭 클릭
3. "템플릿 만들기" 클릭
4. 템플릿 이름: `Bio-MBTI 공유`
5. 템플릿 유형: "피드" 선택
6. 내용 입력:
   - 제목: `{{title}}`
   - 설명: `{{description}}`
   - 이미지: `{{imageUrl}}`
   - 링크: `{{link}}`
7. "저장" 클릭

**참고**: 현재 코드는 `sendDefault`를 사용하므로 템플릿 등록이 필수는 아닙니다. 하지만 프로덕션에서는 템플릿을 등록하는 것을 권장합니다.

### 5. 환경 변수 설정

`frontend/.env` 파일을 생성하거나 수정하여 다음 내용 추가:

```env
# 카카오톡 JavaScript 키
REACT_APP_KAKAO_JS_KEY=your_kakao_javascript_key_here

# 프로덕션 사이트 URL (선택사항, 설정하지 않으면 자동으로 현재 도메인 사용)
# 로컬 개발 시에는 설정하지 않아도 됩니다
# 프로덕션 배포 시에는 실제 도메인을 설정하세요 (예: https://bio-mbti.vercel.app)
REACT_APP_SITE_URL=https://your-production-domain.com
```

**설명:**
- `REACT_APP_KAKAO_JS_KEY`: 카카오톡 JavaScript 키 (필수)
- `REACT_APP_SITE_URL`: 프로덕션 사이트 URL (선택사항)
  - 설정하지 않으면 자동으로 `window.location.origin` 사용
  - 프로덕션 배포 시 설정하면 카카오톡 공유 링크가 올바른 도메인으로 연결됩니다
  - 로컬 개발 시에는 설정하지 않아도 됩니다

### 6. 프론트엔드 재시작

```bash
cd frontend
npm start
```

## ✅ 확인 방법

1. 테스트를 완료하고 결과 페이지로 이동
2. "💬 카카오톡 공유" 버튼 클릭
3. 카카오톡 공유 창이 열리는지 확인
4. 공유 메시지에 제목, 설명, 이미지가 올바르게 표시되는지 확인

## ⚠️ 문제 해결

### 카카오톡 SDK가 로드되지 않는 경우

1. 브라우저 콘솔에서 에러 확인
2. `index.html`에 카카오톡 SDK 스크립트가 추가되었는지 확인
3. 네트워크 탭에서 `kakao.js` 파일이 로드되는지 확인

### JavaScript 키 오류

1. `REACT_APP_KAKAO_JS_KEY` 환경 변수가 설정되었는지 확인
2. JavaScript 키가 올바른지 확인 (앱 키 페이지에서 확인)
3. 프론트엔드를 재시작했는지 확인

### 플랫폼 도메인 오류

1. 카카오톡 개발자 콘솔에서 등록한 도메인 확인
2. 현재 접속한 도메인과 일치하는지 확인
3. 로컬 개발 시 `http://localhost:3000` 등록 필요
4. 프로덕션 배포 시 실제 도메인 등록 필요

### 공유 메시지가 표시되지 않는 경우

1. 카카오톡 앱이 설치되어 있는지 확인
2. 모바일 환경에서 테스트 (카카오톡 공유는 모바일에서만 작동)
3. 브라우저 콘솔에서 에러 확인

### 이미지가 표시되지 않는 경우

1. **이미지 경로 확인**
   - 이미지가 `frontend/public/images/types/` 폴더에 존재하는지 확인
   - 이미지 파일명이 타입 코드와 정확히 일치하는지 확인 (대소문자 구분)
   - 예: `ICLR.png`, `ICLG.png` 등

2. **이미지 크기 확인**
   - 카카오톡은 최소 200x200px 이상의 이미지를 권장합니다
   - 너무 작은 이미지는 표시되지 않을 수 있습니다

3. **HTTPS 확인**
   - 카카오톡은 HTTPS로 접근 가능한 이미지만 크롤링합니다
   - 프로덕션 배포 시 HTTPS가 활성화되어 있는지 확인

4. **Open Graph 메타태그 확인**
   - 브라우저 개발자 도구에서 `<head>` 태그 내 `og:image` 메타태그 확인
   - 이미지 URL이 절대 경로인지 확인 (예: `https://your-domain.com/images/types/ICLR.png`)

5. **카카오톡 디버거 사용**
   - [카카오톡 디버거](https://developers.kakao.com/tool/clear/og)에서 URL을 입력하여 Open Graph 정보 확인
   - 이미지가 올바르게 크롤링되는지 확인

6. **이미지 형식 확인**
   - PNG, JPG, GIF 형식만 지원됩니다
   - WebP 등 다른 형식은 지원되지 않을 수 있습니다

7. **프로덕션 URL 설정**
   - `REACT_APP_SITE_URL` 환경 변수가 올바르게 설정되어 있는지 확인
   - 프로덕션 배포 시 실제 도메인을 설정해야 합니다

## 📝 참고사항

- 카카오톡 공유는 **모바일 환경**에서만 작동합니다
- 데스크톱에서는 카카오톡 웹 버전으로 공유할 수 있습니다
- JavaScript 키는 공개되어도 안전하지만, 악용 방지를 위해 도메인 제한을 설정하는 것을 권장합니다
- 프로덕션 배포 시 실제 도메인을 플랫폼에 등록해야 합니다

